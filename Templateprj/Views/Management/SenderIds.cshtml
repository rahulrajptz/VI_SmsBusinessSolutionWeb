@{
    System.Data.DataTable project = ViewBag.inboundData;

    ViewBag.Title = "Management";
}


<style>
    table.dataTable > tbody > tr > td, table.dataTable > tbody > tr > th, table.dataTable > tfoot > tr > td, table.dataTable > tfoot > tr > th, table.dataTable > thead > tr > td, table.dataTable > thead > tr > th {
        padding: 5px !important;
        outline: 0;
        max-width: 150px;
        width: 150px;
        border-right: 0;
        border-bottom: 0;
        color: black;
    }
    table.dataTable thead > tr > td.sorting, table.dataTable thead > tr > td.sorting_asc, table.dataTable thead > tr > td.sorting_desc, table.dataTable thead > tr > th.sorting, table.dataTable thead > tr > th.sorting_asc, table.dataTable thead > tr > th.sorting_desc {
        font-size: 9.5pt;
        text-align: center;
        font-weight: bold;
        white-space: nowrap !important;
        table-layout: fixed;
        color: black;
    }


    .alert-danger {
        color: white;
    }

    .alert-success {
        color: white;
    }

    hr {
        border: 1px solid #5f004b
    }

    .box {
        /*border: 1px solid #878080;*/
        padding: 20px;
        box-shadow: rgba(0, 0, 0, 0.35) 1px 5px 10px;
        /*min-height: 150px;*/
        /*width:25%;*/
    }

    .blue {
        width: 60%;
        background-color: #57b4eb;
    }

    .yellow {
        width: 30%;
        background-color: yellow;
    }

    .red {
        width: 10%;
        background-color: red;
    }

    .head {
        position: sticky;
        top: 0;
        z-index: 5;
    }

    body {
        font-size: 13px !important;
    }

    .form-control {
        border-radius: 10px;
        height: 20px !important;
        padding: 0px 5px !important;
        font-size: 12px !important;
        background-color: white !important;
        /*color:#5f004b;*/
    }

    .form-group {
        margin-bottom: 4px;
        border-radius: 10px;
    }



    .navstyle {
        border: 0px solid black;
    }

        .navstyle > ul > li {
            border: 1px solid #5f004b;
            /*background-color: #5f004b;*/
            margin-left: 5px;
            border-top-right-radius: 10px;
            border-top-left-radius: 10px;
            width: 200px;
        }

    a {
        color: grey;
    }

        a:hover {
            color: white;
        }

    .active {
        background-color: #5f004b;
        color: white!important;
    }

        .active:hover {
            background-color: #5f004b;
            color: white;
        }

    .nav-link {
        border-top-right-radius: 10px;
        border-top-left-radius: 10px;
    }

    label {
        color: #5f004b;
        font-size: 12px;
    }

    .label_side_head {
        color: #5f004b;
        font-size: 12px;
        font-weight: bold;
    }

    .navclr:hover {
        background-color: #ebecf1;
    }

    .navclr {
        background-color: #ebecf1;
    }
    /*.dropdown-toggle {
        float: right;
    }*/
    .cl-black {
        color: #495057 !important;
    }

    .text-danger {
        width: 109px;
        font-size: 10px;
        height: 0px;
    }

    labelvariable {
        color: #5f004b;
        font-size: 12px;
    }

    .button-edit {
        /*background-color: #5f004b;*/
        border-radius: 10px;
        /*border-bottom-color: #5f004b;*/
        color: white;
        padding: 8px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 12px;
        min-width: 65px !important;
    }
    


</style>

<div class="row" style="margin-top:50px">
    <div class="col">

        @using (Html.BeginForm(null, null, FormMethod.Post, new { enctype = "multipart/form-data", id = "Idform" }))
        {

            <div class="container" style="margin-left:10px">
                <div class="row">
                    <div class="wizard-navigation">
                        <div class="col-xs-12 navstyle">
                            <ul class="nav">
                                <li class="nav-item" style="width: 130px;height:35px">
                                    <a style="font-size:12px;font-weight:bold;" class="nav-link" href="@Url.Action("Account", "Management")">
                                        <span class="now-ui-icons loader_gear sidebar-mini-icon mt-1"></span>
                                        ACCOUNT
                                    </a>
                                </li>
                                <li class="nav-item " style="width: 140px;height:35px">
                                    <a style="font-size:12px;font-weight:bold;" class="nav-link" href="@Url.Action("Templates", "Template")">
                                        <span class="now-ui-icons loader_gear sidebar-mini-icon mt-1"></span>
                                        TEMPLATES
                                    </a>
                                </li>
                                <li class="nav-item arrow" style="width: 150px;height:35px">
                                    <a style="font-size:12px;font-weight:bold;" class="nav-link active" href="@Url.Action("SenderIds", "SenderId")">
                                        <span class="now-ui-icons loader_gear sidebar-mini-icon mt-1"></span>
                                        SENDER ID
                                    </a>
                                </li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" style="margin-left:15px;margin-top:10px;">
                <div class="tab-pane show active navclr">
                    <div class="row" id="divList" style="background-color:white;">
                        <div class="col">
                            @*Listing table*@
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="card" style="border:0px;box-shadow:none;">
                                        <div class="col-12">
                                            <a class="btn btn-outline-info" href="AddSenderId" style="float:right"><span class="fa fa-plus"></span></a>
                                        </div>
                                            <div class="card-body col-12">
                                                <div class="col-12 w-100" id="divTablereport" style="overflow-x:auto !important;">
                                                    <table id="tbl_rptreport" class="table-striped table-bordered dataTable dtr-inline w-100" role="grid" aria-describedby="datatable_info"></table>
                                                </div>
                                                <div class="alert alert-info" id="divNoData" style="display:none;">
                                                    <span>No data found for the search</span>
                                                </div>
                                                <div class="d-flex justify-content-center" id="loading" style="display:none !important;">
                                                    <div class="spinner-grow" role="status">
                                                        <span class="sr-only">Loading...</span>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        }

    </div>
</div>
<div class="spinner1" style="display:none">
    <div class="center-div">
        <div class="spinner-grow text-light" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
</div>
@section scripts {

    <link href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css"></script>

    <script>
     $(document).ready(function () {
     loadReportreport();
     if ('@TempData["Message"]' !== '') {
                SuccessMsg('@TempData["Message"]');
            }
      });

     $(document).on('click', '#btnSearch', function (e) {
                loadReportreport();
       });
     function deleteSender(senderId) {
                $.ajax({
                    url: "@Url.Action("SenderIds", "SenderId")",
                    data: { id: senderId },
                    type: 'DELETE',
                    success: function (e) {
                        jsondata = JSON.parse(e);
                        if (jsondata.status == "1") {
                            location.reload();
                            SuccessMsg("Successfully removed");
                        }
                        else {
                            ErrorMsg("Failed to remove the template.")
                        }
                    }
                });
            }
     function editTemplate(templateId) {
                alert(templateId);
            }
    </script>

    @*List Templates*@
    <script>
        var columnHeaders = [];
        var columnKeys = [];
        function loadReportreport() {

            $("#loading").show();

            $("#divNoData").hide();
            $.get("@Url.Action(MVC.SenderId.GetSenders())", function (resp) {

                    $("#loading").hide();
                    $(".spinner-grow").hide();
                if (jQuery.isEmptyObject(resp)) {
                    $("#divNoData span").text("No data available");
                    $("#divNoData").show();
                    $("#divTablereport").hide();
                }
                else {
                    var headers = [];
                    headers.push({ "data": 'HeaderId', "title": 'Header Id', "name": 'HeaderId' });
                    headers.push({ "data": 'SenderId', "title": 'Sender Id', "name": 'SenderId' });
                    headers.push({ "data": 'TeleMarketer', "title": 'Tele Marketer', "name": 'TeleMarketer' });
                    headers.push({ "data": 'Explanation', "title": 'Explanation', "name": 'Explanation' });
                    headers.push({ "data": 'RegisteredTsp', "title": 'Registered TSP', "name": 'RegisteredTsp' });
                    headers.push({ "data": 'RequestedDate', "title": 'Requested Date', "name": 'RequestedDate' });
                    headers.push({ "data": 'StatusDate', "title": 'Status Date', "name": 'StatusDate' });
                    headers.push({ "data": 'Status', "title": 'Status', "name": 'Status' });
                    headers.push({ "data": 'BlackListedBy', "title": 'BlackListed By', "name": 'BlackListedBy' });
                    headers.push({
                        "title": "Manage",
                        "data": "TemplateId",
                        "width": "50px !mportant",
                        "render": function (data1, type, row) {
                            return `<p>
                                    <a class="edit" title="Add" data-toggle="tooltip" href="AddSenderId/`+ row.SmId + `" style="color: #004d00 !important""><span class='fas fa-edit'></span></a>
                                    </p>`;
                        }
                    });

                    $("#tbl_rptreport").show();
                    $("#divTablereport").show();

                    rpt_datatable = $("#tbl_rptreport").DataTable({
                        responsive: true,
                        deferRender: true,
                        "destroy": true,
                        bFilter: false,
                        bInfo: false,
                        "data": resp,
                        "columns":
                            headers,
                        "columnDefs": [
                            { "width": "30px !important", "targets": 0 }
                        ],
                        fnInitComplete: function (o) {
                            $("#loading").hide();
                            $(".spinner-grow").hide();
                        },
                    });
                }

                }).fail(function (xhr, status, error) {
                    $("#loading").hide();
                    $(".spinner-grow").hide();
                    $("input[type=button]").removeAttr("disabled");
                    if (xhr.status == 401) {
                        alert("Click to continue", "Session Timedout", function () {
                            closing = false;
                            window.location = JSON.parse(xhr.responseText).LogOnUrl;
                        })
                    }
                    else if (xhr.status == 507) {
                        $("#divNoData span").text(" Result is too large.");
                        $("#divNoData").show();
                        $("input[type=button]").removeAttr("disabled");
                    } else {
                        alert("Unable to fetch data from server", "Failed");
                    }
                    });
        }

    </script>

}
